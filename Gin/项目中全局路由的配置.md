# 项目中全局路由的配置

> 项目中可以按照模块分文件，例如：把 /api 作为一个总入口，下面分出不同的子文件。


### router/router.go  项目的全局 api 路由配置文件
``` Go
package router

import (
	"backend/internal/handler"
	"backend/internal/middleware"
	"github.com/gin-gonic/gin"
)

func NewRouter(uHandler *handler.UserHandler) *gin.Engine {
	//r := gin.Default() 等同于
	// r := gin.New()      // 创建一个完全空白的引擎
	// r.Use(gin.Logger())   // 加上日志中间件：控制台会打印每个请求的路径、状态码、耗时
	// r.Use(gin.Recovery()) // 加上异常恢复中间件：即使代码写 Bug 崩了，服务器也不会挂掉，而是返回 500
	r := gin.Default()

	// r.Use() 是 Gin 框架挂载中间件的标准动作。
	//它的意思是：“从现在起，每一个进来的请求，都要先经过我括号里写的这个函数处理。”
	r.Use(middleware.Cors())
	// 在 router.go 里，r.Use(middleware.Cors()) 必须写在路由定义（r.Group）的前面

	apiGroup := r.Group("/api")
	{
		// router/user.go 里自定义的 InitUserRouter 为用户路由导向
		InitUserRouter(apiGroup, uHandler)
	}
	return r
}

```

### router/user.go  用户路由配置文件
``` Go
package router

import (
	"backend/internal/handler"
	"github.com/gin-gonic/gin"
)

// InitUserRouter 专门负责用户模块的路由注册
// UserHandler 来自 handler/user.go 负责处理用户模块的请求
func InitUserRouter(rg *gin.RouterGroup, h *handler.UserHandler) {
	// 创建一个子组 /api/user
	userGroup := rg.Group("/user")
	{
		userGroup.POST("/login", h.DoLogin) // 用户登录路由
		// userGroup.POST("/register", h.DoRegister)  // 用户其他的handler的路由
		// userGroup.GET("/profile", h.GetProfile)
	}
}

```